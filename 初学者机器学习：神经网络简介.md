# åˆå­¦è€…æœºå™¨å­¦ä¹ ï¼šç¥ç»ç½‘ç»œç®€ä»‹

#### ç®€å•è§£é‡Šå®ƒä»¬å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•åœ¨Pythonä¸­ä»å¤´å¼€å§‹å®ç°ä¸€ä¸ªã€‚

**2019å¹´3æœˆ3æ—¥**

è¿™å¯èƒ½ä¼šç»™ä½ å¸¦æ¥æƒŠå–œï¼š**ç¥ç»ç½‘ç»œå¹¶ä¸å¤æ‚**ï¼æœ¯è¯­â€œç¥ç»ç½‘ç»œâ€è¢«å¹¿æ³›ç”¨ä½œæµè¡Œè¯­ï¼Œä½†å®é™…ä¸Šå®ƒä»¬é€šå¸¸æ¯”äººä»¬æƒ³è±¡çš„è¦ç®€å•å¾—å¤šã€‚

**æœ¬æ–‡ä»…ä¾›åˆå­¦è€…ä½¿ç”¨ï¼Œå¹¶å‡è®¾ZEROå…·æœ‰æœºå™¨å­¦ä¹ çš„å…ˆéªŒçŸ¥è¯†**ã€‚æˆ‘ä»¬å°†ç†è§£ç¥ç»ç½‘ç»œå¦‚ä½•åœ¨Pythonä¸­ä»å¤´å¼€å§‹å®ç°ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

## 1. æ„å»ºåŸºå—ï¼šç¥ç»å…ƒ

é¦–å…ˆï¼Œæˆ‘ä»¬è¦è®¨è®ºç¥ç»å…ƒï¼Œç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒã€‚**ç¥ç»å…ƒæ¥å—è¾“å…¥ï¼Œå¯¹å®ƒä»¬è¿›è¡Œä¸€äº›æ•°å­¦è®¡ç®—ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªè¾“å‡º**ã€‚è¿™æ˜¯2è¾“å…¥ç¥ç»å…ƒçš„æ ·å­ï¼š

![img](https://victorzhou.com/perceptron-a74a19dc0599aae11df7493c718abaf9.svg)

è¿™é‡Œå‘ç”Ÿäº†3ä»¶äº‹ã€‚é¦–å…ˆï¼Œæ¯ä¸ªè¾“å…¥ä¹˜ä»¥ä¸€ä¸ªæƒé‡ï¼š![1560694241841](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_001.png)
$$
x1â€‹â†’x1â€‹âˆ—w1
$$

$$
x2â€‹â†’x2â€‹âˆ—w2â€‹
$$

æ¥ä¸‹æ¥ï¼Œæ‰€æœ‰åŠ æƒè¾“å…¥æ·»åŠ åå·®bï¼š![1560694254310](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_002.png)
$$
(x1â€‹âˆ—w1â€‹)+(x2â€‹âˆ—w2â€‹)+b
$$
æœ€åï¼Œæ€»å’Œé€šè¿‡æ¿€æ´»å‡½æ•°ä¼ é€’ï¼š![1560694263987](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_003.png)
$$
y=f(x1â€‹âˆ—w1â€‹+x2â€‹âˆ—w2â€‹+b)
$$
æ¿€æ´»å‡½æ•°ç”¨äºå°†æ— ç•Œè¾“å…¥è½¬æ¢ä¸ºå…·æœ‰è‰¯å¥½ï¼Œå¯é¢„æµ‹å½¢å¼çš„è¾“å‡ºã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°æ˜¯sigmoidå‡½æ•°ï¼š

![1560694296586](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_004.png)

sigmoidå‡½æ•°ä»…è¾“å‡ºèŒƒå›´ï¼ˆ0,1ï¼‰ä¸­çš„æ•°å­—ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºå‹ç¼©ï¼ˆ-âˆï¼Œâˆï¼‰åˆ°ï¼ˆ0,1ï¼‰ï¼ˆ0,1ï¼‰ - è´Ÿæ— ç©·å¤§ä¸ºã€œ0 ï¼Œæ­£æ— ç©·å¤§ä¸ºï½1ã€‚

#### ä¸€ä¸ªç®€å•çš„ä¾‹å­

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª2è¾“å…¥ç¥ç»å…ƒï¼Œå®ƒä½¿ç”¨sigmoidæ¿€æ´»å‡½æ•°å¹¶å…·æœ‰ä»¥ä¸‹å‚æ•°ï¼š
$$
w=[0,1] 
$$

$$
b=4
$$

w=[0,1] åªæ˜¯w1=0,w2=1çš„ä¸€ç§å‘é‡å†™æ³•ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»™ç¥ç»å…ƒä¸€ä¸ªè¾“å…¥x=[2,3]ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ç‚¹ç§¯æ¥æ›´ç®€æ´åœ°å†™å‡ºï¼š
$$
(wâ‹…x)+bâ€‹ =((w1â€‹âˆ—x1â€‹)+(w2â€‹âˆ—x2â€‹))+b  
\\      =0âˆ—2+1âˆ—3+4\\=7
$$

$$
y=f(wâ‹…x+b)=f(7)=0.999
$$
ç»™å®šè¾“å…¥x=[2,3]ç¥ç»å…ƒè¾“å‡º0.999ã€‚å‘å‰ä¼ é€’è¾“å…¥ä»¥è·å¾—è¾“å‡ºçš„è¿‡ç¨‹ç§°ä¸º**å‰é¦ˆ**ã€‚

#### ç¼–å†™ä¸€ä¸ªç¥ç»å…ƒ

æ˜¯æ—¶å€™å®æ–½ä¸€ä¸ªç¥ç»å…ƒäº†ï¼æˆ‘ä»¬å°†ä½¿ç”¨NumPyï¼Œä¸€ä¸ªæµè¡Œä¸”åŠŸèƒ½å¼ºå¤§çš„Pythonè®¡ç®—åº“æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ•°å­¦è¿ç®—ï¼š

```python
import numpy as np

def sigmoid(x):
  # Our activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

class Neuron:
  def __init__(self, weights, bias):
    self.weights = weights
    self.bias = bias

  def feedforward(self, inputs):
    # Weight inputs, add bias, then use the activation function
    total = np.dot(self.weights, inputs) + self.bias
    return sigmoid(total)

weights = np.array([0, 1]) # w1 = 0, w2 = 1
bias = 4                   # b = 4
n = Neuron(weights, bias)

x = np.array([2, 3])       # x1 = 2, x2 = 3
print(n.feedforward(x))    # 0.9990889488055994
```

è®¤è¯†åˆ°è¿™äº›æ•°å­—ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬åˆšåˆšåšçš„ä¾‹å­ï¼æˆ‘ä»¬å¾—åˆ°0.999è¿™ä¸ªç›¸åŒç­”æ¡ˆã€‚

## 2.å°†ç¥ç»å…ƒç»„åˆæˆç¥ç»ç½‘ç»œ

ç¥ç»ç½‘ç»œåªä¸è¿‡æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ä¸€å †ç¥ç»å…ƒã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œå¯èƒ½æ˜¯ä»€ä¹ˆæ ·å­ï¼š

![1560695057057](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_005.png)

è¯¥ç½‘ç»œæœ‰2ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªéšè—å±‚ï¼Œæœ‰2ä¸ªç¥ç»å…ƒï¼ˆh1å’Œh2ï¼‰ï¼Œå’Œä¸€ä¸ªå¸¦æœ‰1ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå±‚ï¼ˆo1ï¼‰ã€‚æ³¨æ„åˆ°o1æ˜¯h1å’Œh2çš„è¾“å‡ºè¿™æ‰æ˜¯ç½‘ç»œå½¢æˆçš„åŸå› ã€‚

> **éšè—å±‚**æ˜¯è¾“å…¥ï¼ˆç¬¬ä¸€ï¼‰å±‚å’Œè¾“å‡ºï¼ˆæœ€åï¼‰å±‚ä¹‹é—´çš„ä»»ä½•å±‚ã€‚å¯ä»¥æœ‰å¤šä¸ªéšè—å±‚ï¼

#### ä¸€ä¸ªä¾‹å­ï¼šå‰é¦ˆ

è®©æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢æç»˜çš„ç½‘ç»œå¹¶å‡è®¾æ‰€æœ‰ç¥ç»å…ƒå…·æœ‰ç›¸åŒçš„æƒé‡w=[0,1]ï¼Œç›¸åŒçš„åå·®b=0,ç›¸åŒçš„sigmoidæ¿€æ´»å‡½æ•°ã€‚è®¾h1ï¼Œh2ï¼Œo1è¡¨ç¤ºå®ƒä»¬ä»£è¡¨çš„ç¥ç»å…ƒçš„è¾“å‡ºã€‚

å¦‚æœæˆ‘ä»¬ä¼ å…¥è¾“å…¥x=[2,3]ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

![1560695646334](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_006.png)

è¾“å…¥x=[2,3]çš„ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ˜¯0.7216.å¾ˆç®€å•ï¼Œå¯¹å—ï¼Ÿ

ç¥ç»ç½‘ç»œå¯ä»¥å…·æœ‰ä»»æ„æ•°é‡çš„å±‚ï¼Œè¿™äº›å±‚ä¸­å…·æœ‰ä»»æ„æ•°é‡çš„ç¥ç»å…ƒã€‚åŸºæœ¬æ€æƒ³ä¿æŒä¸å˜ï¼šé€šè¿‡ç½‘ç»œä¸­çš„ç¥ç»å…ƒå‘å‰é¦ˆé€è¾“å…¥ä»¥è·å¾—æœ€åçš„è¾“å‡ºã€‚ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ä¸Šå›¾æ‰€ç¤ºçš„ç½‘ç»œæ¥å®Œæˆæœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ã€‚

#### ç¼–å†™ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ

è®©æˆ‘ä»¬ä¸ºç¥ç»ç½‘ç»œå®ç°å‰é¦ˆã€‚è¿™æ˜¯ç½‘ç»œçš„å›¾åƒå†æ¬¡ä¾›å‚è€ƒï¼š

![1560695752202](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_007.png)

```python
import numpy as np

# ... code from previous section here

class OurNeuralNetwork:
  '''
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)
  Each neuron has the same weights and bias:
    - w = [0, 1]
    - b = 0
  '''
  def __init__(self):
    weights = np.array([0, 1])
    bias = 0

    # The Neuron class here is from the previous section
    self.h1 = Neuron(weights, bias)
    self.h2 = Neuron(weights, bias)
    self.o1 = Neuron(weights, bias)

  def feedforward(self, x):
    out_h1 = self.h1.feedforward(x)
    out_h2 = self.h2.feedforward(x)

    # The inputs for o1 are the outputs from h1 and h2
    out_o1 = self.o1.feedforward(np.array([out_h1, out_h2]))

    return out_o1

network = OurNeuralNetwork()
x = np.array([2, 3])
print(network.feedforward(x)) # 0.7216325609518421
```

æˆ‘ä»¬åˆå¾—åˆ°äº†0.7216ï¼çœ‹èµ·æ¥å¾ˆæœ‰æ•ˆã€‚

## 3.è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æµ‹é‡å€¼ï¼š

|  Name   | Weight (lb) | Height (in) | Gender |
| :-----: | :---------: | :---------: | :----: |
|  Alice  |     133     |     65      |   F    |
|   Bob   |     160     |     72      |   M    |
| Charlie |     152     |     70      |   M    |
|  Diana  |     120     |     60      |   F    |

è®©æˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„ç½‘ç»œï¼Œæ ¹æ®ä»–ä»¬çš„ä½“é‡å’Œèº«é«˜æ¥é¢„æµ‹æŸäººçš„æ€§åˆ«ï¼š

![1560695886939](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_008.png)

æˆ‘ä»¬å°†ä½¿ç”¨0ä»£è¡¨ç”·æ€§å’Œä½¿ç”¨1ä»£è¡¨å¥³æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå°†è½¬åŒ–æ•°æ®ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ï¼š

|  Name   | Weight (minus 135) | Height (minus 66) | Gender |
| :-----: | :----------------: | :---------------: | :----: |
|  Alice  |         -2         |        -1         |   1    |
|   Bob   |         25         |         6         |   0    |
| Charlie |         17         |         4         |   0    |
|  Diana  |        -15         |        -6         |   1    |

> æˆ‘ä»»æ„çš„é€‰æ‹©äº†è½¬åŒ–çš„å€¼(135,66)è®©æ•°å­—çœ‹èµ·æ¥æ›´èˆ’æœã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨å¹³å‡å€¼å³å¯ã€‚

#### æŸå¤±

åœ¨æˆ‘ä»¬è®­ç»ƒç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ç§æ–¹æ³•æ¥é‡åŒ–å®ƒçš„â€œå¥½â€ç¨‹åº¦ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å°è¯•â€œæ›´å¥½â€ã€‚è¿™å°±æ˜¯æŸå¤±ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰æŸå¤±ï¼š

![1560696121743](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_009.png)

è®©æˆ‘ä»¬æ‹†åˆ†å®ƒï¼š

- næ˜¯æ ·æœ¬çš„æ•°é‡

- yè¡¨ç¤ºé¢„æµ‹çš„å˜é‡ï¼Œå³æ€§åˆ«ã€‚

- y_trueæ˜¯å˜é‡çš„çœŸå®å€¼ï¼ˆâ€œæ­£ç¡®çš„ç­”æ¡ˆâ€ï¼‰ä¾‹å¦‚ï¼Œy_trueå¯¹Aliceæ¥è¯´æ˜¯1

- y_predæ˜¯å˜é‡çš„é¢„æµ‹å€¼ã€‚æˆ‘ä»¬ç¥ç»ç½‘ç»œçš„è¾“å‡ºã€‚

ï¼ˆy_true - y_predï¼‰çš„å¹³æ–¹å€¼æ˜¯æ‰€ç†Ÿæ‚‰çš„å¹³æ–¹è¯¯å·®ã€‚æˆ‘ä»¬çš„æŸå¤±å‡½æ•°åªæ˜¯å–æ‰€æœ‰å¹³æ–¹è¯¯å·®çš„å¹³å‡å€¼ï¼ˆå› æ­¤åç§°å‡æ–¹è¯¯å·®ï¼‰ã€‚æˆ‘ä»¬çš„é¢„æµ‹è¶Šå¥½ï¼Œæˆ‘ä»¬çš„æŸå¤±å°±è¶Šä½ï¼

æ›´å¥½çš„é¢„æµ‹=æ›´ä½çš„æŸå¤±ã€‚

**åŸ¹è®­ç½‘ç»œ=å°½é‡å‡å°‘æŸå¤±ã€‚**

#### ä¸€ä¸ªè¯¯å·®è®¡ç®—çš„ç¤ºä¾‹

å‡è®¾æˆ‘ä»¬çš„ç½‘ç»œæ€»æ˜¯è¾“å‡º0  - æ¢å¥è¯è¯´ï¼Œå®ƒç¡®ä¿¡æ‰€æœ‰äººéƒ½æ˜¯ç”·æ€§ ğŸ¤” æˆ‘ä»¬çš„æŸå¤±æ˜¯ä»€ä¹ˆï¼Ÿ

| Name    | y_true | y_pred | (y_true âˆ’ y_pred)^2 |
| ------- | :----: | :----: | :-----------------: |
| Alice   |   1    |   0    |          1          |
| Bob     |   0    |   0    |          0          |
| Charlie |   0    |   0    |          0          |
| Diana   |   1    |   0    |          1          |

![1560696540866](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_010.png)

#### ä»£ç ï¼šMSEæŸå¤±

ä»¥ä¸‹æ˜¯ä¸ºæˆ‘ä»¬è®¡ç®—æŸå¤±çš„ä¸€äº›ä»£ç ï¼š

```python
import numpy as np

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

y_true = np.array([1, 0, 0, 1])
y_pred = np.array([0, 0, 0, 0])

print(mse_loss(y_true, y_pred)) # 0.5
```

## 4.è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†

æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼šå°½é‡**å‡å°‘ç¥ç»ç½‘ç»œçš„æŸå¤±**ã€‚æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¯ä»¥æ”¹å˜ç½‘ç»œçš„æƒé‡å’Œåå·®ä»¥å½±å“å…¶é¢„æµ‹ï¼Œä½†æˆ‘ä»¬å¦‚ä½•ä»¥å‡å°‘æŸå¤±çš„æ–¹å¼è¿™æ ·åšå‘¢ï¼Ÿ

> æœ¬èŠ‚ä½¿ç”¨äº†ä¸€äº›å¤šå˜é‡å¾®ç§¯åˆ†ã€‚å¦‚æœæ‚¨å¯¹å¾®ç§¯åˆ†ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥éšæ„è·³è¿‡æ•°å­¦éƒ¨åˆ†ã€‚

ä¸ºç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬å‡è£…æˆ‘ä»¬çš„æ•°æ®é›†ä¸­åªæœ‰Aliceï¼š

| Name  | Weight (minus 135) | Height (minus 66) | Gender |
| :---: | :----------------: | :---------------: | :----: |
| Alice |         -2         |        -1         |   1    |

é‚£ä¹ˆå‡æ–¹è¯¯å·®æŸå¤±åªæ˜¯Aliceçš„å¹³æ–¹è¯¯å·®ï¼š

![1560785551167](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_011.png)

è€ƒè™‘æŸå¤±çš„å¦ä¸€ç§æ–¹å¼æ˜¯æƒé‡å’Œåå·®ã€‚è®©æˆ‘ä»¬åœ¨ç½‘ç»œä¸­æ ‡å‡ºæ¯ä¸ªæƒé‡å’Œåè§ï¼š

![1560785571631](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_012.png)

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸå¤±å†™ä¸ºå¤šå˜é‡å‡½æ•°ï¼š


$$
L(w1â€‹,w2â€‹,w3â€‹,w4â€‹,w5â€‹,w6â€‹,b1â€‹,b2â€‹,b3â€‹)
$$
æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³è°ƒæ•´ä¸€ä¸‹w1.å¦‚æœæˆ‘ä»¬æ”¹å˜w1ï¼ŒLä¼šå¦‚ä½•å˜åŒ–ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œåå¯¼æ•°![1560785713654](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_013.png)å¯ä»¥å›ç­”ã€‚æˆ‘ä»¬å¦‚ä½•è®¡ç®—å‘¢ï¼Ÿ

> è¿™æ˜¯æ•°å­¦å¼€å§‹å˜å¾—æ›´å¤æ‚çš„åœ°æ–¹ã€‚ä¸è¦æ°”é¦ï¼æˆ‘å»ºè®®è®©ç¬”å’Œçº¸ä¸€èµ·è·Ÿè¿› - å®ƒä¼šå¸®åŠ©ä½ ç†è§£ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬é‡å†™ä¸€ä¸‹åå¯¼æ•°![1560785760740](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_014.png)

![1560785773253](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_015.png)

> è¿™æ˜¯å› ä¸ºé“¾å¼è§„åˆ™ã€‚

æˆ‘ä»¬å¯ä»¥ç®—ä¸€ç®—![1560785839450](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_016.png)å› ä¸ºæˆ‘ä»¬ç®—äº†![1560785875132](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_017.png)

![1560785983462](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_019.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼„æ¸…æ¥šè¯¥æ€ä¹ˆåš![1560785897969](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_018.png)å°±åƒä»¥å‰é‚£æ ·è®©h1ï¼Œh2ï¼Œo1æˆä¸ºå®ƒä»¬æ‰€ä»£è¡¨çš„ç¥ç»å…ƒçš„è¾“å‡ºã€‚ç„¶åï¼š

![1560785997352](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_020.png)

> fæ˜¯sigmoidæ¿€æ´»å‡½æ•°ï¼Œè¿˜è®°å¾—å—ï¼Ÿ

ç”±äºw1åªå½±å“h1ï¼ˆä¸æ˜¯h2ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å†™

![1560786054680](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_021.png)

æˆ‘ä»¬å¯¹![1560786085343](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_022.png)åšåŒæ ·çš„äº‹æƒ…ï¼š

![1560786099329](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_023.png)

> ä½ çŒœåˆ°äº†ï¼Œé“¾å¼æ³•åˆ™ã€‚ã€‚

x1è¿™é‡Œæ˜¯é‡é‡ï¼Œx2æ˜¯é«˜åº¦ã€‚è¿™æ˜¯æˆ‘ä»¬ç¬¬äºŒæ¬¡çœ‹åˆ°f'ï¼ˆxï¼‰ï¼ˆsigmoidå‡½æ•°çš„æ¨å¯¼ï¼‰ï¼è®©æˆ‘ä»¬æ¨å¯¼å‡ºæ¥ï¼š

![1560786178328](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_024.png)

æˆ‘ä»¬ç¨åä¼šå°†è¿™ä¸ªæ¼‚äº®çš„å½¢å¼ç”¨äºf'ï¼ˆxï¼‰ã€‚

æˆ‘ä»¬å®Œæˆäº†ï¼æˆ‘ä»¬è®¾æ³•å°†![1560786230260](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_025.png)åˆ†è§£æˆæˆ‘ä»¬å¯ä»¥è®¡ç®—çš„å‡ ä¸ªéƒ¨åˆ†ï¼š

![1560786241274](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_026.png)

è¿™ç§é€šè¿‡å‘åå·¥ä½œè®¡ç®—åå¯¼æ•°çš„ç³»ç»Ÿç§°ä¸º**åå‘ä¼ æ’­**æˆ–â€œåå‘ä¼ æ’­â€ã€‚

å”·ã€‚è¿™æ˜¯å¾ˆå¤šç¬¦å· - å¦‚æœä½ ä»ç„¶æœ‰ç‚¹å›°æƒ‘æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹è¿™ä¸ªè¡ŒåŠ¨å§ï¼

#### ç¤ºä¾‹ï¼šè®¡ç®—åå¯¼æ•°

æˆ‘ä»¬å°†ç»§ç»­å‡è£…åªæœ‰Aliceåœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼š

| Name  | Weight (minus 135) | Height (minus 66) | Gender |
| :---: | :----------------: | :---------------: | :----: |
| Alice |         -2         |        -1         |   1    |

è®©æˆ‘ä»¬å°†æ‰€æœ‰æƒé‡åˆå§‹åŒ–ä¸º1ï¼Œå°†æ‰€æœ‰åå·®åˆå§‹åŒ–ä¸º0.å¦‚æœæˆ‘ä»¬é€šè¿‡ç½‘ç»œè¿›è¡Œå‰é¦ˆä¼ é€’ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š

![1560872675440](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_027.png)

ç½‘ç»œè¾“å‡ºy_pred=0.524,ä¸å¼ºçƒˆæ”¯æŒç”·æ€§ï¼ˆ0ï¼‰æˆ–å¥³æ€§ï¼ˆ1ï¼‰.æˆ‘ä»¬ç®—ä¸€ç®—å§![1560872740444](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_028.png):

![1560872768635](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_029.png)

> æé†’ï¼šæˆ‘ä»¬å¯¼å‡ºf'ï¼ˆxï¼‰= fï¼ˆxï¼‰*ï¼ˆ1  -  fï¼ˆxï¼‰ï¼‰æˆ‘ä»¬ä¹‹å‰çš„sigmoidæ¿€æ´»å‡½æ•°ã€‚

æˆ‘ä»¬åšåˆ°äº†ï¼è¿™å‘Šè¯‰æˆ‘ä»¬å¦‚æœæˆ‘ä»¬è¦å¢åŠ w1ï¼Œé‚£ä¹ˆLä¼šå¢åŠ ä¸€ä¸ªtiiinyä½ã€‚

#### è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™

**æˆ‘ä»¬ç°åœ¨æ‹¥æœ‰åŸ¹è®­ç¥ç»ç½‘ç»œæ‰€éœ€çš„æ‰€æœ‰å·¥å…·ï¼**æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç§ç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰çš„ä¼˜åŒ–ç®—æ³•ï¼Œè¯¥ç®—æ³•å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•æ”¹å˜æˆ‘ä»¬çš„æƒé‡å’Œåå·®ä»¥æœ€å°åŒ–æŸå¤±ã€‚å®ƒåŸºæœ¬ä¸Šå°±æ˜¯è¿™ä¸ªæ›´æ–°ç­‰å¼ï¼š

![1560872965542](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_030.png)

Î·æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œç§°ä¸º**å­¦ä¹ ç‡**ï¼Œæ§åˆ¶æˆ‘ä»¬è®­ç»ƒçš„é€Ÿåº¦ã€‚æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯ä»w1å‡å»![1560873018590](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_031.png)

- å¦‚æœ![1560873076843](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_032.png)æ˜¯æ­£çš„ï¼Œw1å°±ä¼šå‡å°ï¼Œéšä¹‹Lä¹Ÿä¼šå‡å°
- å¦‚æœ![1560873076843](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_032.png)æ˜¯è´Ÿçš„ï¼Œw1å°±ä¼šå¢åŠ ï¼Œéšä¹‹Lä¹Ÿä¼šå‡å°

å¦‚æœæˆ‘ä»¬é’ˆå¯¹ç½‘ç»œä¸­çš„æ¯ä¸ªé‡é‡å’Œåå·®åšåˆ°è¿™ä¸€ç‚¹ï¼Œé‚£ä¹ˆæŸå¤±å°†é€æ¸å‡å°‘ï¼Œæˆ‘ä»¬çš„ç½‘ç»œå°†ä¼šæ”¹å–„ã€‚

æˆ‘ä»¬çš„è®­ç»ƒæµç¨‹å¦‚ä¸‹ï¼š

1.ä»æˆ‘ä»¬çš„æ•°æ®é›†ä¸­é€‰æ‹©ä¸€ä¸ªæ ·æœ¬ã€‚è¿™å°±æ˜¯éšæœºæ¢¯åº¦ä¸‹é™çš„åŸå›  - æˆ‘ä»¬ä¸€æ¬¡åªå¯¹ä¸€ä¸ªæ ·æœ¬è¿›è¡Œæ“ä½œã€‚

2.è®¡ç®—ç›¸å¯¹äºæƒé‡æˆ–åå·®çš„æ‰€æœ‰æŸå¤±çš„åå¯¼æ•°

3.ä½¿ç”¨æ›´æ–°å…¬å¼æ›´æ–°æ¯ä¸ªæƒé‡å’Œåå·®ã€‚

4.å›åˆ°ç¬¬1æ­¥ã€‚

è®©æˆ‘ä»¬ç”¨è¡ŒåŠ¨çœ‹çœ‹ï¼

#### ä»£ç ï¼šå®Œæ•´çš„ç¥ç»ç½‘ç»œ

ç°åœ¨ç»ˆäºå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œï¼š

|  Name   | Weight (minus 135) | Height (minus 66) | Gender |
| :-----: | :----------------: | :---------------: | :----: |
|  Alice  |         -2         |        -1         |   1    |
|   Bob   |         25         |         6         |   0    |
| Charlie |         17         |         4         |   0    |
|  Diana  |        -15         |        -6         |   1    |

![1560873280455](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_033.png)

```python
import numpy as np

def sigmoid(x):
  # Sigmoid activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

def deriv_sigmoid(x):
  # Derivative of sigmoid: f'(x) = f(x) * (1 - f(x))
  fx = sigmoid(x)
  return fx * (1 - fx)

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

class OurNeuralNetwork:
  '''
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)

  *** DISCLAIMER ***:
  The code below is intended to be simple and educational, NOT optimal.
  Real neural net code looks nothing like this. DO NOT use this code.
  Instead, read/run it to understand how this specific network works.
  '''
  def __init__(self):
    # Weights
    self.w1 = np.random.normal()
    self.w2 = np.random.normal()
    self.w3 = np.random.normal()
    self.w4 = np.random.normal()
    self.w5 = np.random.normal()
    self.w6 = np.random.normal()

    # Biases
    self.b1 = np.random.normal()
    self.b2 = np.random.normal()
    self.b3 = np.random.normal()

  def feedforward(self, x):
    # x is a numpy array with 2 elements.
    h1 = sigmoid(self.w1 * x[0] + self.w2 * x[1] + self.b1)
    h2 = sigmoid(self.w3 * x[0] + self.w4 * x[1] + self.b2)
    o1 = sigmoid(self.w5 * h1 + self.w6 * h2 + self.b3)
    return o1

  def train(self, data, all_y_trues):
    '''
    - data is a (n x 2) numpy array, n = # of samples in the dataset.
    - all_y_trues is a numpy array with n elements.
      Elements in all_y_trues correspond to those in data.
    '''
    learn_rate = 0.1
    epochs = 1000 # number of times to loop through the entire dataset

    for epoch in range(epochs):
      for x, y_true in zip(data, all_y_trues):
        # --- Do a feedforward (we'll need these values later)
        sum_h1 = self.w1 * x[0] + self.w2 * x[1] + self.b1
        h1 = sigmoid(sum_h1)

        sum_h2 = self.w3 * x[0] + self.w4 * x[1] + self.b2
        h2 = sigmoid(sum_h2)

        sum_o1 = self.w5 * h1 + self.w6 * h2 + self.b3
        o1 = sigmoid(sum_o1)
        y_pred = o1

        # --- Calculate partial derivatives.
        # --- Naming: d_L_d_w1 represents "partial L / partial w1"
        d_L_d_ypred = -2 * (y_true - y_pred)

        # Neuron o1
        d_ypred_d_w5 = h1 * deriv_sigmoid(sum_o1)
        d_ypred_d_w6 = h2 * deriv_sigmoid(sum_o1)
        d_ypred_d_b3 = deriv_sigmoid(sum_o1)

        d_ypred_d_h1 = self.w5 * deriv_sigmoid(sum_o1)
        d_ypred_d_h2 = self.w6 * deriv_sigmoid(sum_o1)

        # Neuron h1
        d_h1_d_w1 = x[0] * deriv_sigmoid(sum_h1)
        d_h1_d_w2 = x[1] * deriv_sigmoid(sum_h1)
        d_h1_d_b1 = deriv_sigmoid(sum_h1)

        # Neuron h2
        d_h2_d_w3 = x[0] * deriv_sigmoid(sum_h2)
        d_h2_d_w4 = x[1] * deriv_sigmoid(sum_h2)
        d_h2_d_b2 = deriv_sigmoid(sum_h2)

        # --- Update weights and biases
        # Neuron h1
        self.w1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w1
        self.w2 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w2
        self.b1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_b1

        # Neuron h2
        self.w3 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w3
        self.w4 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w4
        self.b2 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_b2

        # Neuron o1
        self.w5 -= learn_rate * d_L_d_ypred * d_ypred_d_w5
        self.w6 -= learn_rate * d_L_d_ypred * d_ypred_d_w6
        self.b3 -= learn_rate * d_L_d_ypred * d_ypred_d_b3

      # --- Calculate total loss at the end of each epoch
      if epoch % 10 == 0:
        y_preds = np.apply_along_axis(self.feedforward, 1, data)
        loss = mse_loss(all_y_trues, y_preds)
        print("Epoch %d loss: %.3f" % (epoch, loss))

# Define dataset
data = np.array([
  [-2, -1],  # Alice
  [25, 6],   # Bob
  [17, 4],   # Charlie
  [-15, -6], # Diana
])
all_y_trues = np.array([
  1, # Alice
  0, # Bob
  0, # Charlie
  1, # Diana
])

# Train our neural network!
network = OurNeuralNetwork()
network.train(data, all_y_trues)
```

éšç€ç½‘ç»œçš„å­¦ä¹ ï¼Œæˆ‘ä»¬çš„æŸå¤±ç¨³æ­¥ä¸‹é™ï¼š

![1560873320410](https://github.com/challow0/build_nn/blob/master/image/%E9%80%89%E5%8C%BA_034.png)

æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ç½‘ç»œæ¥é¢„æµ‹æ€§åˆ«ï¼š

```python
# Make some predictions
emily = np.array([-7, -3]) # 128 pounds, 63 inches
frank = np.array([20, 2])  # 155 pounds, 68 inches
print("Emily: %.3f" % network.feedforward(emily)) # 0.951 - F
print("Frank: %.3f" % network.feedforward(frank)) # 0.039 - M
```

